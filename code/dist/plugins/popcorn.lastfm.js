(function(d){var c={},f=function(a){if(a.artist){var b="";b="<h3>"+a.artist.name+"</h3>";b+='<a href="'+a.artist.url+'" target="_blank" style="float:left;margin:0 10px 0 0;"><img src="'+a.artist.image[2]["#text"]+'" alt=""></a>';b+="<p>"+a.artist.bio.summary+"</p>";b+="<hr /><p><h4>Tags</h4><ul>";d.forEach(a.artist.tags.tag,function(e){b+='<li><a href="'+e.url+'">'+e.name+"</a></li>"});b+="</ul></p>";b+="<hr /><p><h4>Similar</h4><ul>";d.forEach(a.artist.similar.artist,function(e){b+='<li><a href="'+
e.url+'">'+e.name+"</a></li>"});b+="</ul></p>";c[a.artist.name.toLowerCase()].htmlString=b}};d.plugin("lastfm",function(){return{_setup:function(a){a._container=document.createElement("div");a._container.style.display="none";a._container.innerHTML="";a.artist=a.artist&&a.artist.toLowerCase()||"";var b=document.getElementById(a.target);if(!b&&d.plugin.debug)throw Error("target container doesn't exist");b&&b.appendChild(a._container);if(!c[a.artist]){c[a.artist]={count:0,htmlString:"Unknown Artist"};
d.getJSONP("http://ws.audioscrobbler.com/2.0/?method=artist.getinfo&artist="+a.artist+"&api_key="+a.apikey+"&format=json&callback=lastFMcallback",f,false)}c[a.artist].count++},start:function(a,b){b._container.innerHTML=c[b.artist].htmlString;b._container.style.display="inline"},end:function(a,b){b._container.style.display="none";b._container.innerHTML=""},_teardown:function(a){--c[a.artist].count||delete c[a.artist];document.getElementById(a.target)&&document.getElementById(a.target).removeChild(a._container)}}}(),
{about:{name:"Popcorn LastFM Plugin",version:"0.1",author:"Steven Weerdenburg",website:"http://sweerdenburg.wordpress.com/"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},target:"lastfm-container",artist:{elem:"input",type:"text",label:"Artist"}}})})(Popcorn);
