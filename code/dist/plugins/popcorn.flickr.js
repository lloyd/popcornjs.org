(function(f){var k=0;f.plugin("flickr",function(a){var b,i=document.getElementById(a.target),g,c,h,e,p=a.numberofimages||4,q=a.height||"50px",r=a.width||"50px",l=a.padding||"5px",s=a.border||"0px";b=document.createElement("div");b.id="flickr"+k;b.style.width="100%";b.style.height="100%";b.style.display="none";k++;if(!i&&f.plugin.debug)throw Error("flickr target container doesn't exist");i&&i.appendChild(b);var m=function(){if(g)setTimeout(function(){m()},5);else{c="http://api.flickr.com/services/rest/?method=flickr.people.findByUsername&";
c+="username="+a.username+"&api_key="+a.apikey+"&format=json&jsoncallback=flickr";f.getJSONP(c,function(d){g=d.user.nsid;n()})}},n=function(){c="http://api.flickr.com/services/feeds/photos_public.gne?";if(g)c+="id="+g+"&";if(a.tags)c+="tags="+a.tags+"&";c+="lang=en-us&format=json&jsoncallback=flickr";f.xhr.getJSONP(c,function(d){var j=document.createElement("p");j.innerHTML="<p style='padding:"+l+";'>"+d.title+"<p/>";f.forEach(d.items,function(o,t){if(t<p){h=document.createElement("a");h.setAttribute("href",
o.link);h.setAttribute("target","_blank");e=document.createElement("img");e.setAttribute("src",o.media.m);e.setAttribute("height",q);e.setAttribute("width",r);e.setAttribute("style","border:"+s+";padding:"+l);h.appendChild(e);j.appendChild(h)}else return false});b.appendChild(j)})};if(a.username&&a.apikey)m();else{g=a.userid;n()}return{start:function(){b.style.display="inline"},end:function(){b.style.display="none"},_teardown:function(d){document.getElementById(d.target)&&document.getElementById(d.target).removeChild(b)}}},
{about:{name:"Popcorn Flickr Plugin",version:"0.2",author:"Scott Downe, Steven Weerdenburg, Annasob",website:"http://scottdowne.wordpress.com/"},options:{start:{elem:"input",type:"number",label:"In"},end:{elem:"input",type:"number",label:"Out"},userid:{elem:"input",type:"text",label:"UserID"},tags:{elem:"input",type:"text",label:"Tags"},username:{elem:"input",type:"text",label:"Username"},apikey:{elem:"input",type:"text",label:"Api_key"},target:"flickr-container",height:{elem:"input",type:"text",
label:"Height"},width:{elem:"input",type:"text",label:"Width"},padding:{elem:"input",type:"text",label:"Padding"},border:{elem:"input",type:"text",label:"Border"},numberofimages:{elem:"input",type:"text",label:"Number of Images"}}})})(Popcorn);
